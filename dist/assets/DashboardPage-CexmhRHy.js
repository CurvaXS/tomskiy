import{K as N,r as D,o as U,c as i,w as t,u as e,a as r,b as l,l as M,m as z,n as E,i as u,F as H,B as h,g as m,p as j,v as O,L as q,M as K,N as p,O as _,P as g,A as s,Q,R as y,q as d,t as f,x as k,S as v,T as C,y as T,h as b,U as G,j as J,V as W}from"./index-BR7W-eoC.js";import{p as X,c as Y,a as Z,n as $,e as ee}from"./index-nbtYRshG.js";import{_ as te,u as le}from"./_plugin-vue_export-helper-Cp86hJrl.js";const ae={key:1},ne={key:1},oe={class:"notification-time"},re={key:1},se={__name:"DashboardPage",setup(ue){const c=le(),w=N(()=>c.user),R=N(()=>c.isAdmin),x=D([{id:1,title:"Лекция по математике, 10А класс",startTime:new Date(new Date().getTime()+36e5),location:"Аудитория 305"},{id:2,title:"Педагогический совет",startTime:new Date(new Date().getTime()+72e5),location:"Конференц-зал"}]),B=D([{id:1,title:"Подготовить материалы к уроку",dueDate:new Date(new Date().getTime()+864e5),priority:"high"},{id:2,title:"Проверить контрольные работы",dueDate:new Date(new Date().getTime()+1728e5),priority:"medium"}]),L=D([{id:1,title:"Изменение в расписании",message:"Урок физики перенесен на среду",timestamp:new Date(new Date().getTime()-36e5),read:!1},{id:2,title:"Новый документ",message:"Вам необходимо ознакомиться с новым приказом",timestamp:new Date(new Date().getTime()-72e5),read:!1}]);U(async()=>{if(c.isAuthenticated)try{await c.fetchCurrentUser()}catch(o){console.error("Failed to load dashboard data:",o)}});const S=async o=>{try{await c.fetchCurrentUser()}catch(a){console.error("Failed to refresh data:",a)}finally{o.target.complete()}},A=async()=>{await(await W.create({component:"ProfilePopover",event,translucent:!0})).present()},I=o=>o?new Date(o).toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",V=o=>({admin:"Администратор",teacher:"Преподаватель",technical:"Технический персонал"})[o]||o,P=o=>({high:"danger",medium:"warning",low:"success"})[o]||"primary",F=o=>({high:"Высокий",medium:"Средний",low:"Низкий"})[o]||o;return(o,a)=>(r(),i(e(J),null,{default:t(()=>[l(e(M),null,{default:t(()=>[l(e(z),null,{default:t(()=>[l(e(E),null,{default:t(()=>a[1]||(a[1]=[u("Главная")])),_:1}),l(e(H),{slot:"end"},{default:t(()=>[l(e(h),{onClick:A},{default:t(()=>[l(e(m),{slot:"icon-only",icon:e(X)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),l(e(j),{class:"ion-padding"},{default:t(()=>[l(e(q),{slot:"fixed",onIonRefresh:a[0]||(a[0]=n=>S(n))},{default:t(()=>[l(e(K))]),_:1}),w.value?(r(),i(e(p),{key:0},{default:t(()=>[l(e(_),null,{default:t(()=>[l(e(g),null,{default:t(()=>[u("Добро пожаловать, "+s(w.value.firstName)+"!",1)]),_:1}),l(e(Q),null,{default:t(()=>[u(s(V(w.value.role)),1)]),_:1})]),_:1}),l(e(y),null,{default:t(()=>[d("p",null,"Последний вход: "+s(I(w.value.lastLogin||new Date)),1)]),_:1})]),_:1})):O("",!0),l(e(p),null,{default:t(()=>[l(e(_),null,{default:t(()=>[l(e(g),null,{default:t(()=>a[2]||(a[2]=[u("Ближайшие события")])),_:1}),l(e(h),{fill:"clear",size:"small","router-link":"/schedule"},{default:t(()=>a[3]||(a[3]=[u(" Открыть расписание ")])),_:1})]),_:1}),l(e(y),null,{default:t(()=>[x.value.length>0?(r(),i(e(k),{key:0,lines:"none"},{default:t(()=>[(r(!0),f(v,null,C(x.value,n=>(r(),i(e(T),{key:n.id},{default:t(()=>[l(e(m),{icon:e(Y),slot:"start",color:"primary"},null,8,["icon"]),l(e(b),null,{default:t(()=>[d("h3",null,s(n.title),1),d("p",null,s(I(n.startTime))+", "+s(n.location),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(r(),f("p",ae,"У вас нет ближайших событий."))]),_:1})]),_:1}),l(e(p),null,{default:t(()=>[l(e(_),null,{default:t(()=>[l(e(g),null,{default:t(()=>a[4]||(a[4]=[u("Текущие задачи")])),_:1}),l(e(h),{fill:"clear",size:"small","router-link":"/tasks"},{default:t(()=>a[5]||(a[5]=[u(" Все задачи ")])),_:1})]),_:1}),l(e(y),null,{default:t(()=>[B.value.length>0?(r(),i(e(k),{key:0,lines:"none"},{default:t(()=>[(r(!0),f(v,null,C(B.value,n=>(r(),i(e(T),{key:n.id},{default:t(()=>[l(e(m),{icon:e(Z),slot:"start",color:P(n.priority)},null,8,["icon","color"]),l(e(b),null,{default:t(()=>[d("h3",null,s(n.title),1),d("p",null,"Срок: "+s(I(n.dueDate)),1)]),_:2},1024),l(e(G),{color:P(n.priority)},{default:t(()=>[u(s(F(n.priority)),1)]),_:2},1032,["color"])]),_:2},1024))),128))]),_:1})):(r(),f("p",ne,"У вас нет активных задач."))]),_:1})]),_:1}),l(e(p),null,{default:t(()=>[l(e(_),null,{default:t(()=>[l(e(g),null,{default:t(()=>a[6]||(a[6]=[u("Уведомления")])),_:1})]),_:1}),l(e(y),null,{default:t(()=>[L.value.length>0?(r(),i(e(k),{key:0,lines:"none"},{default:t(()=>[(r(!0),f(v,null,C(L.value,n=>(r(),i(e(T),{key:n.id},{default:t(()=>[l(e(m),{icon:e($),slot:"start",color:"primary"},null,8,["icon"]),l(e(b),null,{default:t(()=>[d("h3",null,s(n.title),1),d("p",null,s(n.message),1),d("p",oe,s(I(n.timestamp)),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(r(),f("p",re,"У вас нет новых уведомлений."))]),_:1})]),_:1}),R.value?(r(),i(e(p),{key:1},{default:t(()=>[l(e(_),null,{default:t(()=>[l(e(g),null,{default:t(()=>a[7]||(a[7]=[u("Инструменты администратора")])),_:1})]),_:1}),l(e(y),null,{default:t(()=>[l(e(h),{expand:"block","router-link":"/analytics"},{default:t(()=>[l(e(m),{slot:"start",icon:e(ee)},null,8,["icon"]),a[8]||(a[8]=u(" Аналитика "))]),_:1})]),_:1})]),_:1})):O("",!0)]),_:1})]),_:1}))}},ce=te(se,[["__scopeId","data-v-284010cd"]]);export{ce as default};
