import{r as U,K as j,o as ne,t as d,a as r,b as t,w as n,u as e,m as K,n as le,i as y,F as X,B as C,g as k,l as oe,W as Be,X as Te,Y as J,h as V,S,T as H,A as D,q as g,C as Me,c as Y,x as de,y as q,p as ae,Z,D as ze,_ as Re,v as A,$ as G,z as De,H as Pe,J as Q,a0 as ge,a1 as qe,a2 as Ne,U as je,a3 as We,a4 as Qe,L as Je,M as Ke,N as _e,O as ke,P as we,Q as Xe,R as he,s as Ze,a5 as Ce,a6 as Ge,j as et}from"./index-BR7W-eoC.js";import{f as ce,d as be,g as tt,i as Se,j as $e,k as xe,l as nt,m as me,t as ve,o as lt,q as ue,r as ot,s as at,u as st,v as it,w as rt,x as Ie}from"./index-nbtYRshG.js";import{_ as se,d as Ve,s as te,u as Ee}from"./_plugin-vue_export-helper-Cp86hJrl.js";import{D as ut}from"./DocumentModal-jbFA5h9A.js";const dt={key:0,class:"loading-container"},ct={key:1},mt={class:"document-meta"},vt={key:1,class:"empty-state"},ft={key:0},yt={key:1},pt={__name:"DocumentSelectorModal",props:{excludeDocumentIds:{type:Array,default:()=>[]}},emits:["dismiss"],setup($,{emit:L}){const x=L,c=$,v=U(!0),f=U(""),I=U("all"),T=U([]),F=[{value:"report",label:"Отчеты"},{value:"order",label:"Приказы"},{value:"statement",label:"Заявления"},{value:"certificate",label:"Справки"},{value:"methodical",label:"Методические"},{value:"regulation",label:"Положения"},{value:"contract",label:"Договоры"},{value:"other",label:"Прочие"}],B=j(()=>{if(!Array.isArray(T.value))return console.warn("Документы не являются массивом:",T.value),[];let l=T.value.filter(s=>!s||typeof s!="object"?!1:!c.excludeDocumentIds.includes(s.id));if(I.value!=="all"&&(l=l.filter(s=>s.type===I.value)),f.value){const s=f.value.toLowerCase();l=l.filter(p=>p.title?p.title.toLowerCase().includes(s)||p.description&&p.description.toLowerCase().includes(s):!1)}return l});ne(async()=>{await z()});const z=async()=>{v.value=!0;try{const l=await Ve.getDocuments();l&&l.data?Array.isArray(l.data.documents)?T.value=l.data.documents:Array.isArray(l.data)?T.value=l.data:(T.value=[],console.warn("Неожиданный формат данных документов:",l.data)):T.value=[],console.log("Загруженные документы:",T.value)}catch(l){console.error("Ошибка при загрузке документов:",l),T.value=[]}finally{v.value=!1}},N=()=>{},h=()=>{},o=l=>{x("dismiss",{id:l.id,title:l.title}),R()},M=async()=>{const l=await Z.create({component:ut});return l.onDidDismiss().then(async({data:s})=>{s&&await z()}),l.present()},R=()=>{var l;x("dismiss");try{(l=document.querySelector("ion-modal:last-of-type"))==null||l.dismiss()}catch(s){console.error("Ошибка при закрытии модального окна:",s)}},W=l=>{var p;const s=((p=l.mimeType)==null?void 0:p.toLowerCase())||"";return s.includes("image/")?Se:s.includes("pdf")?$e:xe},E=l=>l?new Date(l).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric"}):"",u=l=>{if(!l)return"0 Б";const s=["Б","КБ","МБ","ГБ","ТБ"],p=Math.floor(Math.log(l)/Math.log(1024));return`${(l/Math.pow(1024,p)).toFixed(2)} ${s[p]}`};return(l,s)=>(r(),d(S,null,[t(e(oe),null,{default:n(()=>[t(e(K),null,{default:n(()=>[t(e(le),null,{default:n(()=>s[2]||(s[2]=[y("Выбор документа")])),_:1}),t(e(X),{slot:"end"},{default:n(()=>[t(e(C),{onClick:R},{default:n(()=>[t(e(k),{slot:"icon-only",icon:e(ce)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),t(e(ae),{class:"ion-padding"},{default:n(()=>[t(e(Be),{modelValue:f.value,"onUpdate:modelValue":s[0]||(s[0]=p=>f.value=p),placeholder:"Поиск документов...",onIonInput:N,debounce:"300"},null,8,["modelValue"]),t(e(Te),{modelValue:I.value,"onUpdate:modelValue":s[1]||(s[1]=p=>I.value=p),onIonChange:h,scrollable:""},{default:n(()=>[t(e(J),{value:"all"},{default:n(()=>[t(e(V),null,{default:n(()=>s[3]||(s[3]=[y("Все")])),_:1})]),_:1}),(r(),d(S,null,H(F,p=>t(e(J),{key:p.value,value:p.value},{default:n(()=>[t(e(V),null,{default:n(()=>[y(D(p.label),1)]),_:2},1024)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),v.value?(r(),d("div",dt,[t(e(Me)),s[4]||(s[4]=g("p",null,"Загрузка документов...",-1))])):(r(),d("div",ct,[B.value.length>0?(r(),Y(e(de),{key:0},{default:n(()=>[(r(!0),d(S,null,H(B.value,p=>(r(),Y(e(q),{key:p.id,button:"",onClick:ie=>o(p),class:"document-item"},{default:n(()=>[t(e(k),{icon:W(p),slot:"start",class:"document-icon"},null,8,["icon"]),t(e(V),null,{default:n(()=>[g("h2",null,D(p.title),1),g("p",mt,D(u(p.fileSize))+" | "+D(E(p.createdAt)),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):(r(),d("div",vt,[t(e(k),{icon:e(be),class:"empty-icon"},null,8,["icon"]),f.value?(r(),d("p",ft,'По запросу "'+D(f.value)+'" ничего не найдено',1)):(r(),d("p",yt,"Документы не найдены"))]))])),t(e(C),{expand:"block",onClick:M,class:"upload-button"},{default:n(()=>[t(e(k),{slot:"start",icon:e(tt)},null,8,["icon"]),s[5]||(s[5]=y(" Загрузить новый документ "))]),_:1})]),_:1})],64))}},Dt=se(pt,[["__scopeId","data-v-ae119e38"]]),gt={class:"event-info"},_t={key:0,class:"loading-container"},kt={key:1},wt={class:"document-meta"},ht={key:0,class:"document-note"},Ct={key:1,class:"empty-state"},It={__name:"EventDocumentsModal",props:{event:{type:Object,required:!0}},emits:["dismiss","documentsUpdated"],setup($,{emit:L}){const x=L,c=$,v=U(!0),f=U([]);ne(async()=>{await I()});const I=async()=>{v.value=!0;try{if(!c.event||!c.event.id){console.error("Отсутствует ID события"),E("Невозможно загрузить документы: неизвестное событие","danger"),f.value=[];return}console.log("Загрузка документов для события ID:",c.event.id);const u=await te.getEventDocuments(c.event.id);u&&u.data?(Array.isArray(u.data.documents)?f.value=u.data.documents:Array.isArray(u.data)?f.value=u.data:(console.warn("Неожиданный формат данных:",u.data),f.value=[]),console.log("Загруженные документы события:",f.value)):f.value=[]}catch(u){console.error("Ошибка при загрузке документов:",u);let l="Ошибка при загрузке документов";u.response&&u.response.status===404&&(l="Сервис документов недоступен"),E(l,"danger"),f.value=[]}finally{v.value=!1}},T=async()=>{const u=await Z.create({component:Dt,componentProps:{excludeDocumentIds:f.value.map(l=>l.id)}});return u.onDidDismiss().then(async({data:l})=>{l&&await F(l.id)}),u.present()},F=async(u,l="")=>{try{await te.attachDocument(c.event.id,u,l),await I(),E("Документ успешно прикреплен","success"),x("documentsUpdated")}catch(s){console.error("Ошибка при прикреплении документа:",s),E("Ошибка при прикреплении документа","danger")}},B=async u=>{try{await te.detachDocument(c.event.id,u),await I(),E("Документ успешно откреплен","success"),x("documentsUpdated")}catch(l){console.error("Ошибка при откреплении документа:",l),E("Ошибка при откреплении документа","danger")}},z=async u=>{await(await G.create({header:"Подтверждение",message:`Вы уверены, что хотите открепить документ "${u.title}" от этого события?`,buttons:[{text:"Отмена",role:"cancel"},{text:"Открепить",role:"destructive",handler:()=>{B(u.attachmentId)}}]})).present()},N=async u=>{await(await G.create({header:"Примечание к документу",inputs:[{name:"note",type:"textarea",placeholder:"Введите примечание",value:u.note||""}],buttons:[{text:"Отмена",role:"cancel"},{text:"Сохранить",handler:async s=>{try{await te.updateDocumentNote(c.event.id,u.attachmentId,s.note),await I(),E("Примечание обновлено","success")}catch(p){console.error("Ошибка при обновлении примечания:",p),E("Ошибка при обновлении примечания","danger")}}}]})).present()},h=u=>{window.open(Ve.getDocumentUrl(u.id),"_blank")},o=()=>{var u;x("dismiss");try{(u=document.querySelector("ion-modal:last-of-type"))==null||u.dismiss()}catch(l){console.error("Ошибка при закрытии модального окна:",l)}},M=u=>{var s;const l=((s=u.mimeType)==null?void 0:s.toLowerCase())||"";return l.includes("image/")?Se:l.includes("pdf")?$e:xe},R=u=>u?new Date(u).toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",W=u=>{if(!u)return"0 Б";const l=["Б","КБ","МБ","ГБ","ТБ"],s=Math.floor(Math.log(u)/Math.log(1024));return`${(u/Math.pow(1024,s)).toFixed(2)} ${l[s]}`},E=async(u,l="primary")=>{await(await ze.create({message:u,duration:3e3,position:"bottom",color:l})).present()};return(u,l)=>(r(),d(S,null,[t(e(oe),null,{default:n(()=>[t(e(K),null,{default:n(()=>[t(e(le),null,{default:n(()=>l[0]||(l[0]=[y("Документы события")])),_:1}),t(e(X),{slot:"end"},{default:n(()=>[t(e(C),{onClick:o},{default:n(()=>[t(e(k),{slot:"icon-only",icon:e(ce)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),t(e(ae),{class:"ion-padding"},{default:n(()=>[g("div",gt,[g("h2",null,D($.event.title),1),g("p",null,D(R($.event.startTime))+" - "+D(R($.event.endTime)),1)]),v.value?(r(),d("div",_t,[t(e(Me)),l[1]||(l[1]=g("p",null,"Загрузка документов...",-1))])):(r(),d("div",kt,[f.value.length>0?(r(),Y(e(de),{key:0},{default:n(()=>[t(e(Re),null,{default:n(()=>l[2]||(l[2]=[y("Прикрепленные документы")])),_:1}),(r(!0),d(S,null,H(f.value,s=>(r(),Y(e(q),{key:s.id,class:"document-item"},{default:n(()=>[t(e(k),{icon:M(s),slot:"start",class:"document-icon"},null,8,["icon"]),t(e(V),null,{default:n(()=>[g("h2",null,D(s.title),1),g("p",wt,D(W(s.fileSize))+" | "+D(s.mimeType),1),s.note?(r(),d("p",ht,D(s.note),1)):A("",!0)]),_:2},1024),t(e(X),{slot:"end"},{default:n(()=>[t(e(C),{fill:"clear",onClick:p=>h(s)},{default:n(()=>[t(e(k),{slot:"icon-only",icon:e(nt)},null,8,["icon"])]),_:2},1032,["onClick"]),t(e(C),{fill:"clear",onClick:p=>N(s)},{default:n(()=>[t(e(k),{slot:"icon-only",icon:e(me)},null,8,["icon"])]),_:2},1032,["onClick"]),t(e(C),{fill:"clear",color:"danger",onClick:p=>z(s)},{default:n(()=>[t(e(k),{slot:"icon-only",icon:e(ve)},null,8,["icon"])]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})):(r(),d("div",Ct,[t(e(k),{icon:e(be),class:"empty-icon"},null,8,["icon"]),l[3]||(l[3]=g("p",null,"К этому событию еще не прикреплены документы",-1))])),t(e(C),{expand:"block",onClick:T,class:"add-button"},{default:n(()=>[t(e(k),{slot:"start",icon:e(lt)},null,8,["icon"]),l[4]||(l[4]=y(" Прикрепить документ "))]),_:1})]))]),_:1})],64))}},He=se(It,[["__scopeId","data-v-25db75b2"]]),Tt={class:"documents-section"},Mt={key:0,class:"action-buttons"},bt={__name:"EventDetailsModal",props:{event:{type:Object,default:null}},emits:["dismiss","update","delete"],setup($,{emit:L}){const x=L,c=$,v=Ee(),f=U({title:"",type:"class",startTime:new Date().toISOString(),endTime:new Date(new Date().getTime()+36e5).toISOString(),location:"",description:""}),I=j(()=>{var h,o;return c.event?c.event.creatorId===((h=v.user)==null?void 0:h.id)||((o=v.user)==null?void 0:o.isAdmin):!0});ne(()=>{c.event&&(f.value={...c.event,startTime:c.event.startTime,endTime:c.event.endTime})});const T=()=>{var h;x("dismiss");try{(h=document.querySelector("ion-modal:last-of-type"))==null||h.dismiss()}catch(o){console.error("Ошибка при закрытии модального окна:",o)}},F=async()=>{if(!c.event)return(await G.create({header:"Информация",message:"Прежде чем прикреплять документы, необходимо сохранить событие.",buttons:["ОК"]})).present();const h=await Z.create({component:He,componentProps:{event:c.event}});return h.onDidDismiss().then(({data:o})=>{o&&o.documentsUpdated&&x("update")}),h.present()},B=async()=>{try{x("update",f.value),T()}catch(h){console.error("Ошибка при обновлении события:",h)}},z=async()=>{await(await G.create({header:"Подтверждение",message:`Вы уверены, что хотите удалить событие "${c.event.title}"?`,buttons:[{text:"Отмена",role:"cancel"},{text:"Удалить",role:"destructive",handler:()=>{N()}}]})).present()},N=async()=>{try{x("delete",c.event.id),T()}catch(h){console.error("Ошибка при удалении события:",h)}};return(h,o)=>(r(),d(S,null,[t(e(oe),null,{default:n(()=>[t(e(K),null,{default:n(()=>[t(e(le),null,{default:n(()=>[y(D($.event?"Детали события":"Новое событие"),1)]),_:1}),t(e(X),{slot:"end"},{default:n(()=>[t(e(C),{onClick:T},{default:n(()=>[t(e(k),{slot:"icon-only",icon:e(ce)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),t(e(ae),{class:"ion-padding"},{default:n(()=>[t(e(de),null,{default:n(()=>[t(e(q),null,{default:n(()=>[t(e(V),{position:"stacked"},{default:n(()=>o[6]||(o[6]=[y("Название")])),_:1}),t(e(De),{modelValue:f.value.title,"onUpdate:modelValue":o[0]||(o[0]=M=>f.value.title=M),readonly:"!canEdit"},null,8,["modelValue"])]),_:1}),t(e(q),null,{default:n(()=>[t(e(V),{position:"stacked"},{default:n(()=>o[7]||(o[7]=[y("Тип")])),_:1}),t(e(Pe),{modelValue:f.value.type,"onUpdate:modelValue":o[1]||(o[1]=M=>f.value.type=M),interface:"action-sheet",disabled:"!canEdit"},{default:n(()=>[t(e(Q),{value:"class"},{default:n(()=>o[8]||(o[8]=[y("Занятие")])),_:1}),t(e(Q),{value:"meeting"},{default:n(()=>o[9]||(o[9]=[y("Совещание")])),_:1}),t(e(Q),{value:"exam"},{default:n(()=>o[10]||(o[10]=[y("Экзамен")])),_:1}),t(e(Q),{value:"consultation"},{default:n(()=>o[11]||(o[11]=[y("Консультация")])),_:1}),t(e(Q),{value:"personal"},{default:n(()=>o[12]||(o[12]=[y("Личное")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(e(q),null,{default:n(()=>[t(e(V),{position:"stacked"},{default:n(()=>o[13]||(o[13]=[y("Начало")])),_:1}),t(e(ge),{modelValue:f.value.startTime,"onUpdate:modelValue":o[2]||(o[2]=M=>f.value.startTime=M),"display-format":"DD.MM.YYYY HH:mm","picker-format":"DD MMM YYYY HH:mm",readonly:"!canEdit"},null,8,["modelValue"])]),_:1}),t(e(q),null,{default:n(()=>[t(e(V),{position:"stacked"},{default:n(()=>o[14]||(o[14]=[y("Окончание")])),_:1}),t(e(ge),{modelValue:f.value.endTime,"onUpdate:modelValue":o[3]||(o[3]=M=>f.value.endTime=M),"display-format":"DD.MM.YYYY HH:mm","picker-format":"DD MMM YYYY HH:mm",readonly:"!canEdit"},null,8,["modelValue"])]),_:1}),t(e(q),null,{default:n(()=>[t(e(V),{position:"stacked"},{default:n(()=>o[15]||(o[15]=[y("Место")])),_:1}),t(e(De),{modelValue:f.value.location,"onUpdate:modelValue":o[4]||(o[4]=M=>f.value.location=M),readonly:"!canEdit"},null,8,["modelValue"])]),_:1}),t(e(q),null,{default:n(()=>[t(e(V),{position:"stacked"},{default:n(()=>o[16]||(o[16]=[y("Описание")])),_:1}),t(e(qe),{modelValue:f.value.description,"onUpdate:modelValue":o[5]||(o[5]=M=>f.value.description=M),rows:"4",readonly:"!canEdit"},null,8,["modelValue"])]),_:1})]),_:1}),g("div",Tt,[t(e(Ne),null,{default:n(()=>[t(e(V),null,{default:n(()=>o[17]||(o[17]=[y("Документы")])),_:1}),$.event&&$.event.documentsCount>0?(r(),Y(e(je),{key:0,slot:"end",color:"primary"},{default:n(()=>[y(D($.event.documentsCount),1)]),_:1})):A("",!0)]),_:1}),t(e(C),{expand:"block",onClick:F,class:"document-button"},{default:n(()=>[t(e(k),{slot:"start",icon:e(ue)},null,8,["icon"]),o[18]||(o[18]=y(" Управление документами "))]),_:1})]),$.event&&I.value?(r(),d("div",Mt,[t(e(C),{expand:"block",onClick:B,color:"primary"},{default:n(()=>[t(e(k),{slot:"start",icon:e(me)},null,8,["icon"]),o[19]||(o[19]=y(" Редактировать "))]),_:1}),t(e(C),{expand:"block",onClick:z,color:"danger"},{default:n(()=>[t(e(k),{slot:"start",icon:e(ve)},null,8,["icon"]),o[20]||(o[20]=y(" Удалить "))]),_:1})])):A("",!0)]),_:1})],64))}},St=se(bt,[["__scopeId","data-v-dd71e4a7"]]),$t={class:"date-navigation"},xt={key:0},Vt={class:"time-slots"},Et={class:"time-label"},Ht={class:"events-container"},Ot={key:0},At={key:1},Ut={key:2,class:"documents-indicator"},Yt={key:0,class:"empty-slot"},Lt={key:1,class:"week-view"},Ft={class:"week-header"},Bt={class:"day-name"},zt={class:"week-body"},Rt={class:"week-time-slots"},Pt={class:"week-time-label"},qt={class:"week-day-slots"},Nt={key:0},jt={key:2,class:"month-view"},Wt={class:"month-grid"},Qt={class:"month-weekdays"},Jt={class:"month-days"},Kt=["onClick"],Xt={class:"month-day-number"},Zt={class:"month-day-events"},Gt={key:0,class:"month-day-more"},en={__name:"SchedulePage",setup($){const L=Ee(),x=j(()=>L.isAdmin),c=U("day"),v=U(new Date),f=U(Array.from({length:12},(a,i)=>i+8)),I=U([{id:1,title:"Урок математики",description:"10A класс, алгебра",startTime:new Date(new Date().setHours(9,0,0,0)),endTime:new Date(new Date().setHours(10,30,0,0)),location:"Кабинет 305",type:"class"},{id:2,title:"Педагогический совет",description:"Обсуждение учебного плана",startTime:new Date(new Date().setHours(14,0,0,0)),endTime:new Date(new Date().setHours(15,30,0,0)),location:"Конференц-зал",type:"meeting"},{id:3,title:"Консультация для учеников",description:"Подготовка к экзамену",startTime:new Date(new Date().setHours(16,0,0,0)),endTime:new Date(new Date().setHours(17,0,0,0)),location:"Кабинет 214",type:"consultation"}]),T=j(()=>{const a={weekday:"long",year:"numeric",month:"long",day:"numeric"};return v.value.toLocaleDateString("ru-RU",a)}),F=j(()=>{const a=new Date(v.value),i=a.getDay(),b=a.getDate()-i+(i===0?-6:1);return a.setDate(b),Array.from({length:7},(m,_)=>{const w=new Date(a);return w.setDate(a.getDate()+_),{date:w,name:w.toLocaleDateString("ru-RU",{weekday:"short"})}})}),B=j(()=>{const a=v.value.getFullYear(),i=v.value.getMonth();let m=new Date(a,i,1).getDay()||7;m=m-1;const _=new Date(a,i+1,0),w=[];for(let O=m-1;O>=0;O--){const P=new Date(a,i,-O);w.push({date:P,events:re(P)})}for(let O=1;O<=_.getDate();O++){const P=new Date(a,i,O);w.push({date:P,events:re(P)})}const Fe=42-w.length;for(let O=1;O<=Fe;O++){const P=new Date(a,i+1,O);w.push({date:P,events:re(P)})}return w}),z=()=>{c.value==="day"?v.value.setDate(v.value.getDate()-1):c.value==="week"?v.value.setDate(v.value.getDate()-7):c.value==="month"&&v.value.setMonth(v.value.getMonth()-1),v.value=new Date(v.value)},N=()=>{c.value==="day"?v.value.setDate(v.value.getDate()+1):c.value==="week"?v.value.setDate(v.value.getDate()+7):c.value==="month"&&v.value.setMonth(v.value.getMonth()+1),v.value=new Date(v.value)},h=()=>{c.value==="day"?c.value="month":c.value="day"},o=async a=>{try{setTimeout(()=>{a.target.complete()},1e3)}catch(i){console.error("Failed to refresh schedule data:",i),a.target.complete()}},M=async()=>{alert("Добавление нового события")},R=async a=>{const i=await Z.create({component:St,componentProps:{event:a}});return i.onDidDismiss().then(({data:b})=>{b&&o()}),i.present()},W=async a=>{const i=await Z.create({component:He,componentProps:{event:a}});return i.onDidDismiss().then(({data:b})=>{b&&b.documentsUpdated&&o()}),i.present()},E=a=>{R(a)},u=async a=>{await(await G.create({header:"Подтверждение",message:`Вы уверены, что хотите удалить событие "${a.title}"?`,buttons:[{text:"Отмена",role:"cancel"},{text:"Удалить",role:"destructive",handler:()=>l(a)}]})).present()},l=a=>{I.value=I.value.filter(i=>i.id!==a.id)},s=a=>{v.value=new Date(a),c.value="day"},p=a=>`${a}:00`,ie=(a,i)=>{const b=m=>m.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"});return`${b(a)} - ${b(i)}`},Oe=a=>a.getDate(),fe=a=>I.value.filter(i=>i.startTime.getHours()===a&&ee(i.startTime,v.value)),Ae=(a,i)=>I.value.filter(b=>b.startTime.getHours()===a&&ee(b.startTime,i)),re=a=>I.value.filter(i=>ee(i.startTime,a)),ee=(a,i)=>a.getDate()===i.getDate()&&a.getMonth()===i.getMonth()&&a.getFullYear()===i.getFullYear(),Ue=a=>a.getMonth()===v.value.getMonth()&&a.getFullYear()===v.value.getFullYear(),ye=a=>ee(a,new Date),pe=a=>({class:"primary",meeting:"tertiary",consultation:"success",personal:"warning"})[a.type]||"medium",Ye=a=>({class:"var(--ion-color-primary)",meeting:"var(--ion-color-tertiary)",consultation:"var(--ion-color-success)",personal:"var(--ion-color-warning)"})[a.type]||"var(--ion-color-medium)",Le=a=>{var i;return x.value||a.createdBy===((i=L.user)==null?void 0:i.id)};return ne(async()=>{}),We(c,async a=>{}),(a,i)=>{const b=Qe("ion-badge");return r(),Y(e(et),null,{default:n(()=>[t(e(oe),null,{default:n(()=>[t(e(K),null,{default:n(()=>[t(e(le),null,{default:n(()=>i[3]||(i[3]=[y("Расписание")])),_:1}),t(e(X),{slot:"end"},{default:n(()=>[x.value?(r(),Y(e(C),{key:0,onClick:M},{default:n(()=>[t(e(k),{slot:"icon-only",icon:e(ot)},null,8,["icon"])]),_:1})):A("",!0),t(e(C),{onClick:h},{default:n(()=>[t(e(k),{slot:"icon-only",icon:c.value==="day"?e(at):e(st)},null,8,["icon"])]),_:1})]),_:1})]),_:1}),t(e(K),null,{default:n(()=>[t(e(Te),{modelValue:c.value,"onUpdate:modelValue":i[0]||(i[0]=m=>c.value=m)},{default:n(()=>[t(e(J),{value:"day"},{default:n(()=>[t(e(V),null,{default:n(()=>i[4]||(i[4]=[y("День")])),_:1})]),_:1}),t(e(J),{value:"week"},{default:n(()=>[t(e(V),null,{default:n(()=>i[5]||(i[5]=[y("Неделя")])),_:1})]),_:1}),t(e(J),{value:"month"},{default:n(()=>[t(e(V),null,{default:n(()=>i[6]||(i[6]=[y("Месяц")])),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(e(ae),{class:"ion-padding"},{default:n(()=>[t(e(Je),{slot:"fixed",onIonRefresh:i[1]||(i[1]=m=>o(m))},{default:n(()=>[t(e(Ke))]),_:1}),g("div",$t,[t(e(C),{fill:"clear",onClick:z},{default:n(()=>[t(e(k),{slot:"icon-only",icon:e(it)},null,8,["icon"])]),_:1}),g("h2",null,D(T.value),1),t(e(C),{fill:"clear",onClick:N},{default:n(()=>[t(e(k),{slot:"icon-only",icon:e(rt)},null,8,["icon"])]),_:1})]),c.value==="day"?(r(),d("div",xt,[g("div",Vt,[(r(!0),d(S,null,H(f.value,m=>(r(),d("div",{key:m,class:"time-slot"},[g("div",Et,D(p(m)),1),g("div",Ht,[(r(!0),d(S,null,H(fe(m),_=>(r(),Y(e(_e),{key:_.id,color:pe(_),onClick:w=>R(_),class:"event-card"},{default:n(()=>[t(e(ke),null,{default:n(()=>[t(e(we),null,{default:n(()=>[y(D(_.title),1)]),_:2},1024),t(e(Xe),null,{default:n(()=>[y(D(ie(_.startTime,_.endTime)),1)]),_:2},1024)]),_:2},1024),t(e(he),null,{default:n(()=>[_.location?(r(),d("p",Ot,[t(e(k),{icon:e(Ie)},null,8,["icon"]),y(" "+D(_.location),1)])):A("",!0),_.description?(r(),d("p",At,D(_.description),1)):A("",!0),_.documentsCount&&_.documentsCount>0?(r(),d("div",Ut,[t(e(k),{icon:e(ue)},null,8,["icon"]),t(b,null,{default:n(()=>[y(D(_.documentsCount),1)]),_:2},1024)])):A("",!0),Le(_)?(r(),d("div",{key:3,class:"event-actions",onClick:i[2]||(i[2]=Ze(()=>{},["stop"]))},[t(e(C),{size:"small",fill:"clear",onClick:w=>E(_)},{default:n(()=>[t(e(k),{icon:e(me)},null,8,["icon"])]),_:2},1032,["onClick"]),t(e(C),{size:"small",fill:"clear",color:"primary",onClick:w=>W(_)},{default:n(()=>[t(e(k),{icon:e(ue)},null,8,["icon"])]),_:2},1032,["onClick"]),t(e(C),{size:"small",fill:"clear",color:"danger",onClick:w=>u(_)},{default:n(()=>[t(e(k),{icon:e(ve)},null,8,["icon"])]),_:2},1032,["onClick"])])):A("",!0)]),_:2},1024)]),_:2},1032,["color","onClick"]))),128)),fe(m).length===0?(r(),d("div",Yt)):A("",!0)])]))),128))])])):c.value==="week"?(r(),d("div",Lt,[g("div",Ft,[(r(!0),d(S,null,H(F.value,m=>(r(),d("div",{class:"day-header",key:m.date},[g("div",Bt,D(m.name),1),g("div",{class:Ce(["day-date",{"current-day":ye(m.date)}])},D(Oe(m.date)),3)]))),128))]),g("div",zt,[g("div",Rt,[(r(!0),d(S,null,H(f.value,m=>(r(),d("div",{key:m,class:"week-hour"},[g("div",Pt,D(p(m)),1),g("div",qt,[(r(!0),d(S,null,H(F.value,_=>(r(),d("div",{key:_.date,class:"week-day-slot"},[(r(!0),d(S,null,H(Ae(m,_.date),w=>(r(),Y(e(_e),{key:w.id,color:pe(w),class:"week-event"},{default:n(()=>[t(e(ke),null,{default:n(()=>[t(e(we),null,{default:n(()=>[y(D(w.title),1)]),_:2},1024)]),_:2},1024),t(e(he),null,{default:n(()=>[g("p",null,D(ie(w.startTime,w.endTime)),1),w.location?(r(),d("p",Nt,[t(e(k),{icon:e(Ie)},null,8,["icon"]),y(" "+D(w.location),1)])):A("",!0)]),_:2},1024)]),_:2},1032,["color"]))),128))]))),128))])]))),128))])])])):(r(),d("div",jt,[g("div",Wt,[g("div",Qt,[(r(),d(S,null,H(["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],m=>g("div",{key:m,class:"month-weekday"},D(m),1)),64))]),g("div",Jt,[(r(!0),d(S,null,H(B.value,m=>(r(),d("div",{key:m.date.toISOString(),class:Ce(["month-day",{"different-month":!Ue(m.date),"current-day":ye(m.date)}]),onClick:_=>s(m.date)},[g("div",Xt,D(m.date.getDate()),1),g("div",Zt,[(r(!0),d(S,null,H(m.events.slice(0,2),_=>(r(),d("div",{key:_.id,class:"month-day-event",style:Ge({backgroundColor:Ye(_)})},D(_.title),5))),128)),m.events.length>2?(r(),d("div",Gt," +"+D(m.events.length-2)+" еще ",1)):A("",!0)])],10,Kt))),128))])])]))]),_:1})]),_:1})}}},an=se(en,[["__scopeId","data-v-beaf315d"]]);export{an as default};
